// Contains:
// jquery.tweet.js - See http://tweet.seaofclouds.com/ or https://github.com/seaofclouds/tweet for more info
// Copyright (c) 2008-2012 Todd Matthews & Steve Purcell

(function(b){if(typeof define==="function"&&define.amd){define(["jquery"],b)}else{b(jQuery)}}(function(b){b.fn.tweet=function(D){var a=b.extend({username:null,list:null,favorites:false,query:null,avatar_size:null,count:3,fetch:null,page:1,retweets:true,intro_text:null,outro_text:null,join_text:null,auto_join_text_default:" I said, ",auto_join_text_ed:" I ",auto_join_text_ing:" I am ",auto_join_text_reply:" I replied to ",auto_join_text_url:" I was looking at ",loading_text:null,refresh_interval:null,twitter_url:"twitter.com",twitter_api_url:"api.twitter.com",twitter_search_url:"search.twitter.com",template:"{avatar}{time}{join} {text}",comparator:function(c,d){return d.tweet_time-c.tweet_time},filter:function(c){return true}},D);var F=/\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi;function t(e,d){if(typeof e==="string"){var g=e;for(var f in d){var c=d[f];g=g.split("{"+f+"}").join(c===null?"":c)}return g}else{return e(d)}}b.extend({tweet:{t:t}});function A(c,d){return function(){var e=[];this.each(function(){e.push(this.replace(c,d))});return b(e)}}function u(c){return c.replace(/</g,"&lt;").replace(/>/g,"^&gt;")}b.fn.extend({linkUser:A(/(^|[\W])@(\w+)/gi,'$1<span class="at">@</span><a href="http://'+a.twitter_url+'/$2">$2</a>'),linkHash:A(/(?:^| )[\#]+([\w\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0600-\u06ff]+)/gi,' <a href="http://'+a.twitter_search_url+"/search?q=&tag=$1&lang=all"+((a.username&&a.username.length==1&&!a.list)?"&from="+a.username.join("%2BOR%2B"):"")+'" class="tweet_hashtag">#$1</a>'),makeHeart:A(/(&lt;)+[3]/gi,"<tt class='heart'>&#x2665;</tt>")});function B(c,d){return c.replace(F,function(g){var h=(/^[a-z]+:/i).test(g)?g:"http://"+g;var e=g;for(var f=0;f<d.length;++f){var i=d[f];if(i.url==h&&i.expanded_url){h=i.expanded_url;e=i.display_url;break}}return'<a href="'+u(h)+'">'+u(e)+"</a>"})}function v(c){return Date.parse(c.replace(/^([a-z]{3})( [a-z]{3} \d\d?)(.*)( \d{4})$/i,"$1,$2$4$3"))}function o(f){var d=function(g){return parseInt(g,10)};var e=new Date();var c=d((e.getTime()-f)/1000);if(c<1){c=0}return{days:d(c/86400),hours:d(c/3600),minutes:d(c/60),seconds:d(c)}}function E(c){if(c.days>2){return"about "+c.days+" days ago"}if(c.hours>24){return"about a day ago"}if(c.hours>2){return"about "+c.hours+" hours ago"}if(c.minutes>45){return"about an hour ago"}if(c.minutes>2){return"about "+c.minutes+" minutes ago"}if(c.seconds>1){return"about "+c.seconds+" seconds ago"}return"just now"}function y(c){if(c.match(/^(@([A-Za-z0-9-_]+)) .*/i)){return a.auto_join_text_reply}else{if(c.match(F)){return a.auto_join_text_url}else{if(c.match(/^((\w+ed)|just) .*/im)){return a.auto_join_text_ed}else{if(c.match(/^(\w*ing) .*/i)){return a.auto_join_text_ing}else{return a.auto_join_text_default}}}}}function C(){var e=("https:"==document.location.protocol?"https:":"http:");var f=(a.fetch===null)?a.count:a.fetch;var c="&include_entities=1&callback=?";if(a.list){return e+"//"+a.twitter_api_url+"/1/"+a.username[0]+"/lists/"+a.list+"/statuses.json?page="+a.page+"&per_page="+f+c}else{if(a.favorites){return e+"//"+a.twitter_api_url+"/1/favorites.json?screen_name="+a.username[0]+"&page="+a.page+"&count="+f+c}else{if(a.query===null&&a.username.length==1){return e+"//"+a.twitter_api_url+"/1/statuses/user_timeline.json?screen_name="+a.username[0]+"&count="+f+(a.retweets?"&include_rts=1":"")+"&page="+a.page+c}else{var d=(a.query||"from:"+a.username.join(" OR from:"));return e+"//"+a.twitter_search_url+"/search.json?&q="+encodeURIComponent(d)+"&rpp="+f+"&page="+a.page+c}}}}function s(d,c){if(c){return("user" in d)?d.user.profile_image_url_https:s(d,false).replace(/^http:\/\/[a-z0-9]{1,3}\.twimg\.com\//,"https://s3.amazonaws.com/twitter_production/")}else{return d.profile_image_url||d.user.profile_image_url}}function w(d){var c={};c.item=d;c.source=d.source;c.screen_name=d.from_user||d.user.screen_name;c.name=d.from_user_name||d.user.name;c.retweet=typeof(d.retweeted_status)!="undefined";c.tweet_time=v(d.created_at);c.join_text=a.join_text=="auto"?y(d.text):a.join_text;c.tweet_id=d.id_str;c.twitter_base="http://"+a.twitter_url+"/";c.user_url=c.twitter_base+c.screen_name;c.tweet_url=c.user_url+"/status/"+c.tweet_id;c.reply_url=c.twitter_base+"intent/tweet?in_reply_to="+c.tweet_id;c.retweet_url=c.twitter_base+"intent/retweet?tweet_id="+c.tweet_id;c.favorite_url=c.twitter_base+"intent/favorite?tweet_id="+c.tweet_id;c.retweeted_screen_name=c.retweet&&d.retweeted_status.user.screen_name;c.tweet_relative_time=E(o(c.tweet_time));c.entities=d.entities?(d.entities.urls||[]).concat(d.entities.media||[]):[];c.tweet_raw_text=c.retweet?("RT @"+c.retweeted_screen_name+" "+d.retweeted_status.text):d.text;c.tweet_text=b([B(c.tweet_raw_text,c.entities)]).linkUser().linkHash()[0];c.retweeted_tweet_text=b([B(d.text,c.entities)]).linkUser().linkHash()[0];c.tweet_text_fancy=b([c.tweet_text]).makeHeart()[0];c.avatar_size=a.avatar_size;c.avatar_url=s(c.retweet?d.retweeted_status:d,(document.location.protocol==="https:"));c.avatar_screen_name=c.retweet?c.retweeted_screen_name:c.screen_name;c.avatar_profile_url=c.twitter_base+c.avatar_screen_name;c.user=t('<a class="tweet_user" href="{user_url}">{screen_name}</a>',c);c.join=a.join_text?t('<span class="tweet_join">{join_text}</span>',c):"";c.avatar=c.avatar_size?t('<a class="tweet_avatar" href="{avatar_profile_url}"><img src="{avatar_url}" height="{avatar_size}" width="{avatar_size}" alt="{avatar_screen_name}\'s avatar" title="{avatar_screen_name}\'s avatar" border="0"/></a>',c):"";c.time=t('<span class="tweet_time"><a href="{tweet_url}" title="view tweet on twitter">{tweet_relative_time}</a></span>',c);c.text=t('<span class="tweet_text">{tweet_text_fancy}</span>',c);c.retweeted_text=t('<span class="tweet_text">{retweeted_tweet_text}</span>',c);c.reply_action=t('<a class="tweet_action tweet_reply" href="{reply_url}">reply</a>',c);c.retweet_action=t('<a class="tweet_action tweet_retweet" href="{retweet_url}">retweet</a>',c);c.favorite_action=t('<a class="tweet_action tweet_favorite" href="{favorite_url}">favorite</a>',c);return c}function z(d,c){var e=b('<ul class="tweet_list">');e.append(b.map(c,function(f){return"<li>"+t(a.template,f)+"</li>"}).join("")).children("li:first").addClass("tweet_first").end().children("li:odd").addClass("tweet_even").end().children("li:even").addClass("tweet_odd");b(d).empty().append(e);if(a.intro_text){e.before('<p class="tweet_intro">'+a.intro_text+"</p>")}if(a.outro_text){e.after('<p class="tweet_outro">'+a.outro_text+"</p>")}b(d).trigger("loaded").trigger((c.length===0?"empty":"full"));if(a.refresh_interval){window.setTimeout(function(){b(d).trigger("tweet:load")},1000*a.refresh_interval)}}function x(d){var c=b('<p class="loading">'+a.loading_text+"</p>");if(a.loading_text){b(d).not(":has(.tweet_list)").empty().append(c)}b.getJSON(C(),function(f){var e=b.map(f.results||f,w);e=b.grep(e,a.filter).sort(a.comparator).slice(0,a.count);b(d).trigger("tweet:retrieved",[e])})}return this.each(function(d,c){if(a.username&&typeof(a.username)=="string"){a.username=[a.username]}b(c).unbind("tweet:render").unbind("tweet:retrieved").unbind("tweet:load").bind({"tweet:load":function(){x(c)},"tweet:retrieved":function(f,e){b(c).trigger("tweet:render",[e])},"tweet:render":function(f,e){z(b(c),e)}}).trigger("tweet:load")})}}));function Splash(){this.mobile=650;this.tablet=980;this.splash=$("section#splash");this.ads=this.splash.find("div.ad-container div.ad-contents ul");this.adContainer=this.splash.find("div.ad-container");this.adContents=this.splash.find("div.ad-container div.ad-contents");this.button=this.splash.children("div.button");this.contentOpen=false;this.jewels=this.splash.children("ul.jewels");this.mode="desktop";this.social=$("article#social");this.window=$(window);this.images=[];var a=this;setTimeout(function(){a.init()},1000);this.displayButton();this.jewelNav();this.arrowNav();this.toggleContents();$(window).resize(function(){a.displayButton();a.adjustMeasurements()})}Splash.prototype.init=function(){var a=this;this.jewels.children("li").each(function(c,e){var d=$(this);var b=new Image();b.src=d.attr("data-background");a.images.push(b.src);b.onload=function(){if(d.hasClass("active")){a.adContainer.css("background-image","url("+b.src+")").children("div").addClass("show-background")}}})};Splash.prototype.jewelNav=function(){var a=this;this.jewels.children("li").click(function(){var b=$(this);if(!b.hasClass("active")){a.adContents.addClass("transition");setTimeout(function(){b.siblings("li").removeClass("active");b.addClass("active");a.adContainer.removeAttr("style").css("background-image","url("+b.attr("data-background")+")");a.adContents.removeClass("transition");a.adContents.find("ul li.active").removeClass("active");a.adContents.find("ul li").eq(b.index()).addClass("active")},250)}})};Splash.prototype.arrowNav=function(){var a=this;this.splash.children("span.nav").click(function(){var c=$(this);var b=a.jewels.children("li.active").index();if(c.hasClass("right")){if(b<a.jewels.children("li").length-1){b++}else{b=0}}else{if(a.jewels.children("li.active").index()>0){b--}else{b=a.jewels.children("li:last").index()}}a.adContents.addClass("transition");setTimeout(function(){a.jewels.children("li.active").removeClass("active");a.jewels.children("li").eq(b).addClass("active");a.adContainer.removeAttr("style").css("background-image","url("+a.images[b]+")");a.adContents.removeClass("transition");a.adContents.find("ul li.active").removeClass("active");a.adContents.find("ul li").eq(b).addClass("active");a.resetDisplay();a.displayButton()},250)})};Splash.prototype.displayButton=function(){var a=this.window.width();if(a<=this.mobile){this.mode!="mobile"?this.resetDisplay():false;this.mode="mobile";return}if(a<=this.tablet){this.mode!="tablet"?this.resetDisplay():false;this.mode="tablet";this.ads.find("li.active div.splash-right").length?this.showButton():this.hideButton()}if(a>this.tablet){this.mode="desktop";this.hideButton()}};Splash.prototype.showButton=function(){this.button.addClass("show")};Splash.prototype.hideButton=function(){this.button.removeClass("show");this.resetDisplay()};Splash.prototype.toggleContents=function(){var a=this;this.button.children("button").click(function(){var d=a.ads.children("li.active");var e;if(a.mode=="mobile"){var b=0;if(d.hasClass("show")){a.contentsOpen=false;a.resetDisplay()}else{a.contentsOpen=true;var c=d.find("div.splash-right");if(c.length){a.ads.find("li.active div.splash-left").append('<div class="delete-me">'+c.html()+"</div>")}d.addClass("show");b=d.children("div:first").height();a.button.css("top",(100+b-18+20)+"px").children("button").text("Show Less");a.social.css("margin-top",b+20+"px")}}if(a.mode=="tablet"){e=d.children("div.splash-right");if(e.hasClass("show")){a.contentsOpen=false;a.resetDisplay()}else{a.contentsOpen=true;e.addClass("show");a.button.css("top",(500+e.height()-18+20)+"px").children("button").text("Show Less");a.social.css("margin-top",e.height()+"px")}}})};Splash.prototype.adjustMeasurements=function(){if(this.contentsOpen){var a;if(this.mode=="tablet"){a=this.ads.find("li.active div:last").height();this.button.css("top",(500+a-18+20)+"px");this.social.css("margin-top",a+"px")}else{a=this.ads.find("li.active div:first").height();this.button.css("top",(100+a-18+20)+"px");this.social.css("margin-top",a+20+"px")}}};Splash.prototype.resetDisplay=function(){this.adContents.find(".show").removeClass("show");this.adContents.find("div.delete-me").remove();this.button.removeAttr("style").children("button").text("Show More");this.social.removeAttr("style");this.contentsOpen=false};(function(a){a(function(){new Splash();a("article#calendar ul.event-list li").click(function(){var c=a(this);var b=a("article#calendar ul.event-details");if(!c.hasClass("active")){c.siblings("li").removeClass("active");c.addClass("active");b.children("li.active").removeClass("active");b.children("li").eq(c.index()).addClass("active")}});a("article#calendar span.nav").click(function(){var e=a(this);var d=a("article#calendar ul.event-details");var b=a("article#calendar ul.event-list");var c=d.children("li.active").index();if(e.hasClass("right")){if(c<d.children("li").length-1){c++}else{c=0}}else{if(d.children("li.active").index()>0){c--}else{c=d.children("li:last").index()}}d.children("li.active").removeClass("active");d.children("li").eq(c).addClass("active");b.children("li.active").removeClass("active");b.children("li").eq(c).addClass("active")});a("article.twitter-post").tweet({count:1,username:"sgaatgcc"})})})(jQuery);